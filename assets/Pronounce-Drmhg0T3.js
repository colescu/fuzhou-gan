import{d as I,c as p,o as n,h as o,a$ as D,aN as G,W as h,t as N,i as v,g as y,F as $,a_ as S,u as t,Q as Y,b as R,R as _,G as A,r as ee,bI as O,k,bJ as te,w as d,aq as q,$ as ne,s as X,bK as E,a6 as H,x as le,aZ as z,_ as J,n as ae,a3 as se,p as oe,bL as re,b0 as ie,bM as ue,T as de,bN as pe,a5 as P,B as F,X as L,V as me,N as T,v as j}from"./app-xu_rIrQu.js";import{_ as ye}from"./DoublePronunciation.vue_vue_type_script_setup_true_lang-FNerEmEF.js";import{_ as ge}from"./ConstrainedPopover.vue_vue_type_script_setup_true_lang--KJy-mnC.js";import{S as ce,P as fe}from"./StopCircleOutline-CHL7KWTv.js";import{u as ve}from"./use-message-9RR7GwEH.js";import{N as ke}from"./Input-S2MnwnLo.js";import{N as he}from"./Card-Bahq3B2W.js";import"./Double.vue_vue_type_script_setup_true_lang-BbNtm_Nk.js";const we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ce=I({name:"CloseCircle",render:function(w,g){return n(),p("svg",we,g[0]||(g[0]=[o("path",{d:"M256 48C141.31 48 48 141.31 48 256s93.31 208 208 208s208-93.31 208-208S370.69 48 256 48zm75.31 260.69a16 16 0 1 1-22.62 22.62L256 278.63l-52.69 52.68a16 16 0 0 1-22.62-22.62L233.37 256l-52.68-52.69a16 16 0 0 1 22.62-22.62L256 233.37l52.69-52.68a16 16 0 0 1 22.62 22.62L278.63 256z",fill:"currentColor"},null,-1)]))}}),be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},$e=I({name:"CopyOutline",render:function(w,g){return n(),p("svg",be,g[0]||(g[0]=[o("rect",{x:"128",y:"128",width:"336",height:"336",rx:"57",ry:"57",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),o("path",{d:"M383.5 128l.5-24a56.16 56.16 0 0 0-56-56H112a64.19 64.19 0 0 0-64 64v216a56.16 56.16 0 0 0 56 56h24",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),Be={class:"char no-simplify"},Ne={key:0},Me={key:1},Se={class:"char no-simplify"},Ie={key:2},Pe={key:3},Re=I({__name:"EntryInline",props:{entry:{},sourceFormat:{},language:{},noAudio:{type:Boolean}},setup(c){const w=D(c,["entry"]),g=G();return(r,l)=>(n(),p("span",null,[o("span",Be,N(r.entry.字頭),1),o("span",null,[l[0]||(l[0]=v(" ",-1)),r.entry.記錄讀音?h("",!0):(n(),p($,{key:0},[v("*")],64)),y(ye,S({pronunciation:r.entry.讀音},w),null,16,["pronunciation"])]),r.entry.層?(n(),p("sub",Ne," "+N(r.entry.層),1)):h("",!0),r.entry.訓作?(n(),p("span",Me,[l[3]||(l[3]=v(" ",-1)),r.entry.訓作==="？"?(n(),p($,{key:0},[v("本字存疑")],64)):(n(),p($,{key:1},[l[1]||(l[1]=v("訓作「",-1)),o("span",Se,N(r.entry.訓作),1),l[2]||(l[2]=v("」",-1))],64))])):h("",!0),r.entry.訓作==null&&r.entry.MC?(n(),p("span",Ie,"  "+N(r.entry.MC.音韻地位(t(g).orderingMCInfo)),1)):h("",!0),r.entry.釋義?(n(),p("span",Pe,"  "+N(r.entry.釋義),1)):h("",!0)]))}}),ze={key:0,class:"char",style:{"white-space":"pre"}},Fe={class:"vertical-radio-buttons"},Le={key:1,class:"no-data"},Te=I({__name:"InterlinearBlock",props:Y({char:{},entries:{},style:{},sourceFormat:{},language:{},noAudio:{type:Boolean}},{modelValue:{default:0},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const w=G(),g=D(c,["char","entries","style"]),r=R(()=>c.style==="ruby"),l=_(c,"modelValue"),b=R(()=>{const f=c.entries[l.value];return f===void 0?null:f.讀音});A(b,()=>{b.value==null&&(l.value=0)},{immediate:!0});const B=ee(!1);return O(),(f,m)=>t(te)(f.char)?(n(),k(H(r.value?"ruby":"div"),{key:1,class:"interlinear"},{default:d(()=>[o("span",null,[y(ge,{show:B.value,"onUpdate:show":m[3]||(m[3]=i=>B.value=i),style:{padding:"0.4em 0"}},{trigger:d(()=>[(n(),k(H(r.value?"rb":"span"),null,{default:d(()=>[o("span",{class:le(["char",{clickable:f.entries.length>0,highlight:new Set(f.entries.filter(i=>i.層!=="官").map(i=>i.讀音)).size>1}]),style:{display:"inline-block","line-height":"1em"}},N(f.char),3)]),_:1}))]),default:d(()=>[y(t(q),{name:"radio",value:l.value,"onUpdate:value":[m[0]||(m[0]=i=>l.value=i),m[1]||(m[1]=i=>B.value=!1)],onClick:m[2]||(m[2]=ne(()=>{},["stop"]))},{default:d(()=>[o("div",Fe,[(n(!0),p($,null,X(f.entries,(i,M)=>(n(),k(t(E),{key:M,value:M},{default:d(()=>[y(Re,S({entry:i},{ref_for:!0},g),null,16,["entry"])]),_:2},1032,["value"]))),128))])]),_:1},8,["value"])]),_:1},8,["show"])]),r.value?(n(),p($,{key:1},[m[4]||(m[4]=o("rp",null,"(",-1)),o("rt",null,[b.value!=null?(n(),k(z,S({key:0,pronunciation:b.value},g),null,16,["pronunciation"])):h("",!0)]),m[5]||(m[5]=o("rp",null,")",-1))],64)):(n(),p($,{key:0},[b.value!=null?(n(),p($,{key:0},[o("span",null,[t(w).format==="pinyin"||t(w).displayBoth?(n(),k(z,S({key:0,pronunciation:b.value,format:"pinyin"},g),null,16,["pronunciation"])):h("",!0)]),o("span",null,[t(w).format==="ipaStrict"||t(w).displayBoth?(n(),k(z,S({key:0,pronunciation:b.value,format:"ipaStrict"},g),null,16,["pronunciation"])):h("",!0)])],64)):(n(),p("span",Le,"無"))],64))]),_:1})):(n(),p("span",ze,N(f.char),1))}}),Ue=J(Te,[["__scopeId","data-v-d93a5e05"]]),Ae={style:{position:"relative"}},Ee={style:{position:"relative"}},U=1e3,Ge=I({__name:"Pronounce",props:{language:{default:"FG"}},setup(c){const w=G(),g=ve(),r=ae(),{input:l,outputChoicesMap:b,outputStyle:B,prefer新:f,prefer文:m}=se(r.pronounce),i=oe(b.value,c.language),M=R(()=>Array.from({length:l.value.length}).map((u,e)=>{const s=re(l.value[e],c.language);return s.some(a=>a.記錄讀音!=null)?s.filter(a=>a.記錄讀音!=null):w.includePredicted?s:[]})),x=R(()=>M.value.map((u,e)=>{const s=l.value[e],a=u[i.value[e]],C=a===void 0?"":a.讀音;return{character:s,pronunciation:C}}));function K(u){return[...Array(u.length).keys()].filter(s=>{const a=u[s];return!(f.value&&a.層?.includes("老")||m.value&&a.層?.includes("白"))})?.[0]??0}A(l,(u,e)=>{const s=M.value.map(K);if(e){let a=0,C=0;for(;a<u.length&&u[a]===e[a];)a+=1;for(;C<Math.min(u.length,e.length)-a&&u[u.length-1-C]===e[e.length-1-C];)C+=1;i.value=[...i.value.slice(0,a),...s.slice(a,u.length-C),...i.value.slice(e.length-C)]}else i.value=s;u.length>=U&&g.warning("字数已达上限！")},{immediate:!0}),ie();const{toggleAudio:Q,isPlaying:V}=c.language==="FG"?ue(x):{};A(()=>c.language,()=>{c.language==="FG"&&pe()},{immediate:!0}),O();async function W(){const u=x.value.map(e=>e.character===`
`?e.character:`[${e.character}]{${e.pronunciation}}`).join("");await window.navigator.clipboard.writeText(u),g.success("複製成功")}const Z=!1;return(u,e)=>(n(),p($,null,[y(t(T),{vertical:""},{default:d(()=>[o("div",Ae,[y(t(ke),{id:"input","input-props":{name:"input"},type:"textarea",maxlength:U,value:t(l),"onUpdate:value":e[0]||(e[0]=s=>P(l)?l.value=s:null),placeholder:`請輸入文本（上限 ${U} 字）`,autosize:{minRows:5}},null,8,["value","placeholder"]),t(l)?(n(),k(t(F),{key:0,class:"floating-icon",style:{bottom:"1em",right:"1em"},onClick:e[1]||(e[1]=s=>l.value=""),text:""},{default:d(()=>[y(t(L),{component:t(Ce)},null,8,["component"])]),_:1})):h("",!0)]),o("div",Ee,[y(t(he),{id:"output"},{default:d(()=>[(n(!0),p($,null,X(t(l),(s,a)=>(n(),k(Ue,{key:a,char:s,entries:M.value[a],modelValue:i.value[a],"onUpdate:modelValue":C=>i.value[a]=C,language:u.language,style:me(t(B))},null,8,["char","entries","modelValue","onUpdate:modelValue","language","style"]))),128))]),_:1}),Z&&t(l)?(n(),k(t(F),{key:0,class:"floating-icon",style:{top:"1em",right:"1em"},onClick:W,text:""},{default:d(()=>[y(t(L),{component:t($e)},null,8,["component"])]),_:1})):h("",!0),t(l)&&u.language==="FG"?(n(),k(t(F),{key:1,class:"floating-icon",style:{bottom:"0.85em",right:"0.85em"},onClick:t(Q),text:""},{default:d(()=>[y(t(L),{component:t(V)?t(ce):t(fe),size:"large"},null,8,["component"])]),_:1},8,["onClick"])):h("",!0)]),y(t(T),{align:"center",justify:"end",style:{margin:"0.5em 0"}},{default:d(()=>[y(t(T),{align:"end",vertical:""},{default:d(()=>[o("div",null,[e[7]||(e[7]=o("span",null,"顯示方式： ",-1)),y(t(q),{value:t(B),"onUpdate:value":e[2]||(e[2]=s=>P(B)?B.value=s:null),name:"ruby",size:"small"},{default:d(()=>[y(t(E),{value:"interlinear"},{default:d(()=>[...e[5]||(e[5]=[v(" 对照式 ",-1)])]),_:1}),y(t(E),{value:"ruby"},{default:d(()=>[...e[6]||(e[6]=[v(" 注音式 ",-1)])]),_:1})]),_:1},8,["value"])]),o("div",null,[y(t(j),{checked:t(f),"onUpdate:checked":e[3]||(e[3]=s=>P(f)?f.value=s:null)},{default:d(()=>[...e[8]||(e[8]=[v("优先新派音",-1)])]),_:1},8,["checked"]),y(t(j),{checked:t(m),"onUpdate:checked":e[4]||(e[4]=s=>P(m)?m.value=s:null)},{default:d(()=>[...e[9]||(e[9]=[v("优先文读音",-1)])]),_:1},8,["checked"])])]),_:1})]),_:1})]),_:1}),(n(),k(de,{to:"#help"},[e[10]||(e[10]=v(" 點擊字可查看字條詳情或選擇",-1)),e[11]||(e[11]=o("span",{class:"highlight"},"多音字",-1)),e[12]||(e[12]=v("的讀音。",-1)),e[13]||(e[13]=o("br",null,null,-1)),e[14]||(e[14]=v(" 字條中星號 * 標記未收錄的理论推導音。 ",-1))]))],64))}}),Ke=J(Ge,[["__scopeId","data-v-15d1eb16"]]);export{Ke as default};
